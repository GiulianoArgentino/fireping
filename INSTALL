Install os dependencies
-----------------------
sudo apt-get install fping php php-xml php-mbstring php-zip git supervisor

Install composer
----------------
php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
php -r "if (hash_file('SHA384', 'composer-setup.php') === '544e09ee996cdf60ece3804abc52599c22b1f40f4323403c44d44fdfdd586475ca9813a858088ffbc1f233e9b180f061') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;"
php composer-setup.php
php -r "unlink('composer-setup.php');"
sudo mv composer.phar /usr/local/bin/composer

Install fireping
----------------
cd /opt
git clone https://github.com/jimmycleuren/fireping.git

cd fireping
composer install

Slave configuration
-------------------

When asked for the initial parameters, you can leave everything as default except the following:

    slave.name: <give a name to this slave>
    slave.url: <the base url for the fireping master>

Configure supervisor
--------------------
vi /etc/supervisor/supervisord.conf and append the following

[program:fireping-slave]
command=php /opt/fireping/bin/console app:probe:dispatcher --env=slave
process_name=%(process_num)d
numprocs=1
directory=/tmp
autostart=true
autorestart=true
startsecs=5
startretries=20
redirect_stderr=false
stdout_logfile=/var/log/supervisor/fireping-slave.out.log
stdout_capture_maxbytes=1MB
stdout_logfile_backups=3
stderr_logfile=/var/log/supervisor/fireping-slave.error.log
stderr_capture_maxbytes=1MB
stderr_logfile_backups=3

Extra steps master
------------------
sudo apt-get install mariadb-server php-mysql nginx php-fpm redis-server acl php-rrd
sudo mysql
create database fireping;
CREATE USER 'fireping'@'localhost' IDENTIFIED BY 'password';
GRANT ALL PRIVILEGES ON fireping . * TO 'fireping'@'localhost';
FLUSH PRIVILEGES;

php bin/console doctrine:migrations:migrate

# Remember to update the parameters.yml file to reflect any changes to database usernames or passwords.
# Also set your hosts file to 192.168.230.11 fireping.test on Windows for any master deployments.